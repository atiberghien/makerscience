<ng-form
  novalidate
  name="mediaForm"
  class="gallery-form"
  ng-class="{ 'has-error' : mediaForm.$invalid }"
  check-form>
    <label>Sélectionner le type de ressource à ajouter <span class="required">*</span></label>
    <tabset>
        <tab select="newMedia.type = 'document'">
            <tab-heading>
                <span class="glyphicon glyphicon-file"></span>
                Document
            </tab-heading>
            <div class="row">
                <div class="col-md-4">
                    <inputfile id="file-document" fileread="newMedia.file" label="newMedia.file.name || 'Parcourir...'" set-title="setTitle(newMedia.file.name)"></inputfile>
                </div>
                <div class="col-md-8">
                    <p ng-show="mediaForm.$error.documentFileFormat" class="help-block">Format non valide, vérifiez le format du document ou changer de type de média</p>
                </div>
            </div>
            <label for="title-document">Titre</label>
            <input id="title-document" type="text" ng-model="newMedia.title" />

            <label for="description-document">Description</label>
            <textarea
                ui-tinymce="tinyMceFullOptions"
                ng-trim="false"
                name="description-document"
                id="description-document"
                ng-model="newMedia.description"
                e-rows="4">
            </textarea>

            <div class="radio-block">
                <p>Auteur de la ressource <span class="required">*</span></p>
                <div class="row">
                  <div class="col-md-4">
                    <label>
                        <input type="radio" ng-model="newMedia.isAuthor" ng-value="true" ng-change="newMedia.isAuthor ? newMedia.author = user : newMedia.author = ''" />
                        Vous faite partie des auteurs
                    </label>
                  </div>
                  <div class="col-md-6">
                    <label>
                        <input type="radio" ng-model="newMedia.isAuthor" ng-value="false" ng-change="newMedia.isAuthor ? newMedia.author = user : newMedia.author = ''" />
                        Vous n'êtes pas auteur et vous recommandez la ressource
                    </label>
                  </div>
                </div>
            </div>

            <label for="author-document">Nom de l'auteur<span class="required">*</span></label>
            <input id="author-document" type="text" ng-model="newMedia.author" ng-disabled="newMedia.isAuthor" />

            <div ng-hide="newMedia.isAuthor">
                <label for="review-document">Avis sur la ressource</label>
                <textarea
                  ui-tinymce="tinyMceFullOptions"
                  ng-trim="false"
                  name="review-document"
                  id="review-document"
                  ng-model="newMedia.review"
                  e-rows="4">
                </textarea>
            </div>

        </tab>
        <tab select="newMedia.type = 'link'">
            <tab-heading>
                <span class="glyphicon glyphicon-link"></span>
                Site web
            </tab-heading>
            <label for="media-url">Ajouter un lien</label>
            <input id="media-url" type="text" ng-model="newMedia.url" placeholder="http://" ng-change="setUrl(newMedia.url)" />
            <label for="title-document">Titre</label>
            <input id="title-document" type="text" ng-model="newMedia.title" />

            <label for="description-document">Description</label>
            <textarea
                ui-tinymce="tinyMceFullOptions"
                ng-trim="false"
                name="description-document"
                id="description-document"
                ng-model="newMedia.description"
                e-rows="4">
            </textarea>

            <div class="radio">
                <p>Auteur de la ressource <span class="required">*</span></p>
                <div class="row">
                  <div class="col-md-4">
                    <label>
                        <input type="radio" ng-model="newMedia.isAuthor" ng-value="true" ng-change="newMedia.isAuthor ? newMedia.author = user : newMedia.author = newMedia.url" />
                        Vous faite partie des auteurs
                    </label>
                  </div>
                  <div class="col-md-6">
                    <label>
                        <input type="radio" ng-model="newMedia.isAuthor" ng-value="false" ng-change="newMedia.isAuthor ? newMedia.author = user : newMedia.author = newMedia.url" />
                        Vous n'êtes pas auteur et vous recommandez la ressource
                    </label>
                  </div>
                </div>
            </div>

            <label for="author-document">Nom de l'auteur <span class="required">*</span></label>
            <input id="author-document" type="text" ng-model="newMedia.author" disabled />

            <div ng-hide="newMedia.isAuthor">
                <label for="review-document">Avis sur la ressource</label>
                <textarea
                  ui-tinymce="tinyMceFullOptions"
                  ng-trim="false"
                  name="review-document"
                  id="review-document"
                  ng-model="newMedia.review"
                  e-rows="4">
                </textarea>
            </div>
        </tab>
        <tab select="newMedia.type = 'experience'">
            <tab-heading>
                <span class="glyphicon glyphicon-list-alt"></span>
                Expérience
            </tab-heading>
            <label for="media-experience">Ajouter un lien vers une vidéo</label>
            <input id="media-experience" type="text" ng-model="newMedia.url" placeholder="http://" />
        </tab>
    </tabset>

    <p ng-show="$scope.mediaForm.$pristine" class="help-block">Veuillez sélectionner un fichier ou insérer un lien</p>

    <div class="row">
        <div class="pull-right col-md-2" ng-hide="hideControls">
            <button type="button" class="btn btn-primary item-validate" ng-click="addMedia(newMedia)">Valider</button>
        </div>
    </div>
</ng-form>
<hr>
<ul class="gallery-thumbnails thumbnails">
    <li ng-if="media" ng-repeat="media in medias.concat(projectsheet.bucket.files) track by $index" style="float: left;text-align: center;">
        <p class="filename">
          <span ng-switch on="media.type">
              <i class="glyphicon glyphicon-file" ng-switch-when="document"></i>
              <i class="glyphicon glyphicon-link" ng-switch-when="link"></i>
              <i class="glyphicon glyphicon-list-alt" ng-switch-when="experience"></i>
          </span>
          {{media.title}}
        </p>
        <button type="button" class="btn btn-danger btn-xs" ng-click="remove(media)">
            <span class="glyphicon glyphicon-trash"></span> Supprimer
        </button>
    </li>
</ul>
